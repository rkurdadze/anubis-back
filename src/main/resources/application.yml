spring:
  application:
    name: anubis

  datasource:
    url: ${ANUBIS_DB_URL:jdbc:postgresql://localhost:5432/anubis}
    username: ${ANUBIS_DB_USER:postgres}
    password: ${ANUBIS_DB_PASSWORD:postgres}
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: none
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        type:
          preferred_enum_type: postgres_enum
    open-in-view: false
    show-sql: false

  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration
    placeholders:
      schema: public

server:
  port: 4100


# ==========================
# üîç ANUBIS Custom Settings
# ==========================
anubis:
  ocr:
    enabled: ${ANUBIS_OCR_ENABLED:true}
    service-url: ${ANUBIS_OCR_SERVICE_URL:http://localhost:4101}
    languages: ${ANUBIS_OCR_LANGUAGES:kat+eng+rus}

    # –¢–∞–π–º–∞—É—Ç—ã HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤
    connect-timeout: ${ANUBIS_OCR_CONNECT_TIMEOUT:5s}
    read-timeout: ${ANUBIS_OCR_READ_TIMEOUT:60s}
    request-timeout: ${ANUBIS_OCR_REQUEST_TIMEOUT:90s}

    # –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ OCR –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    auto-start-container: ${ANUBIS_OCR_AUTOSTART:true}
    docker-compose-file: ${ANUBIS_OCR_DOCKER_COMPOSE:docker/ocr/docker-compose.yml}
    docker-compose-service: ${ANUBIS_OCR_DOCKER_SERVICE:ocr-gateway}

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ OCR-—à–ª—é–∑–∞
    readiness-timeout: ${ANUBIS_OCR_READINESS_TIMEOUT:120s}
    health-check-interval: ${ANUBIS_OCR_HEALTH_INTERVAL:2s}

  language-detect:
    enabled: ${ANUBIS_LANGUAGE_DETECT_ENABLED:true}

  storage:
    temp-dir: ${ANUBIS_STORAGE_TMP:/tmp/anubis}
    external-base-path: ${ANUBIS_STORAGE_FS:/data/anubis}

  preview:
    enabled: ${ANUBIS_PREVIEW_ENABLED:true}
    gotenberg:
      base-url: ${ANUBIS_GOTENBERG_URL:http://localhost:3000}
      connect-timeout: ${ANUBIS_GOTENBERG_CONNECT_TIMEOUT:5s}
      read-timeout: ${ANUBIS_GOTENBERG_READ_TIMEOUT:60s}


# ==========================
# ü™µ Logging configuration
# ==========================
logging:
  level:
    root: INFO
    org.flywaydb: INFO
    org.apache.fontbox.cff: ERROR  # üîá –ø–æ–¥–∞–≤–ª—è–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    org.apache.pdfbox.pdmodel.font.PDType0Font: ERROR
    org.apache.pdfbox.pdmodel.font.PDSimpleFont: ERROR
    org.apache.pdfbox.pdmodel.font: ERROR
    reactor.netty.http.client.HttpClientConnect: ERROR  # üîá —É–±–∏—Ä–∞–µ–º Connection reset –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ OCR
    io.netty.resolver.dns.DnsServerAddressStreamProviders: OFF

