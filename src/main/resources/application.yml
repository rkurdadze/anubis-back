spring:
  application:
    name: anubis

  datasource:
    url: ${ANUBIS_DB_URL:jdbc:postgresql://localhost:5432/anubis}
    username: ${ANUBIS_DB_USER:postgres}
    password: ${ANUBIS_DB_PASSWORD:postgres}
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: none
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        type:
          preferred_enum_type: postgres_enum
    open-in-view: false
    show-sql: false

  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration
    placeholders:
      schema: public

server:
  port: 4100


# ==========================
# üîç ANUBIS Custom Settings
# ==========================
anubis:
  ocr:
    enabled: ${ANUBIS_OCR_ENABLED:true}
    datapath: ${TESSDATA_PREFIX:${ANUBIS_OCR_DATAPATH:}}
    languages: ${ANUBIS_OCR_LANGUAGES:kat+eng+rus}
    psm: ${ANUBIS_OCR_PSM:3}
    oem: ${ANUBIS_OCR_OEM:1}
    fallback-enabled: ${ANUBIS_OCR_FALLBACK_ENABLED:true}
    fallback-min-length: ${ANUBIS_OCR_FALLBACK_MIN_LENGTH:120}
    combine-with-tika: ${ANUBIS_OCR_COMBINE_WITH_TIKA:true}
    dpi: ${ANUBIS_OCR_DPI:300}

  language-detect:
    enabled: ${ANUBIS_LANGUAGE_DETECT_ENABLED:true}

  tika:
    max-content-length: ${ANUBIS_TIKA_MAX_CONTENT_LENGTH:10485760}
    parse-timeout-seconds: ${ANUBIS_TIKA_TIMEOUT:30}

  storage:
    temp-dir: ${ANUBIS_STORAGE_TMP:/tmp/anubis}
    external-base-path: ${ANUBIS_STORAGE_FS:/data/anubis}

  preview:
    enabled: ${ANUBIS_PREVIEW_ENABLED:true}
    gotenberg:
      base-url: ${ANUBIS_GOTENBERG_URL:http://localhost:3000}
      connect-timeout: ${ANUBIS_GOTENBERG_CONNECT_TIMEOUT:5s}
      read-timeout: ${ANUBIS_GOTENBERG_READ_TIMEOUT:60s}

  # ==========================
  # üß© PDF / OCR / Fonts Settings
  # ==========================
  pdfbox:
    fontdir: /Library/Fonts:/System/Library/Fonts
    fontcache: /tmp/pdf-font-cache
    use-fallback-fonts: true


# ==========================
# ü™µ Logging configuration
# ==========================
logging:
  level:
    root: INFO
    org.flywaydb: INFO
    org.apache.fontbox.cff: ERROR  # üîá –ø–æ–¥–∞–≤–ª—è–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    org.apache.pdfbox.pdmodel.font.PDType0Font: ERROR
    org.apache.pdfbox.pdmodel.font.PDSimpleFont: ERROR
    org.apache.pdfbox.pdmodel.font: ERROR